<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chinacoal.ins.proposal.car.dao.GuPolicyRiskMapper">
  <resultMap id="BaseResultMap" type="com.chinacoal.ins.proposal.car.pojo.GuPolicyRisk">
    <id column="POLICYNO" jdbcType="VARCHAR" property="policyNo" />
    <id column="PLANCODE" jdbcType="VARCHAR" property="planCode" />
    <id column="RISKCODE" jdbcType="VARCHAR" property="riskCode" />
    <result column="STARTDATE" jdbcType="TIMESTAMP" property="startDate" />
    <result column="ENDDATE" jdbcType="TIMESTAMP" property="endDate" />
    <result column="STARTTIMEZONE" jdbcType="VARCHAR" property="startTimeZone" />
    <result column="ENDTIMEZONE" jdbcType="VARCHAR" property="endTimeZone" />
    <result column="COMMENCEDATE" jdbcType="TIMESTAMP" property="commenceDate" />
    <result column="RETROACTIVESTARTDATE" jdbcType="TIMESTAMP" property="retroActiveStartDate" />
    <result column="RETROACTIVEENDDATE" jdbcType="TIMESTAMP" property="retroActiveEndDate" />
    <result column="CURRENCY" jdbcType="VARCHAR" property="currency" />
    <result column="SUMVALUE" jdbcType="DECIMAL" property="sumValue" />
    <result column="SUMINSURED" jdbcType="DECIMAL" property="sumInsured" />
    <result column="SUMGROSSPREMIUM" jdbcType="DECIMAL" property="sumGrossPremium" />
    <result column="COMMISSION" jdbcType="DECIMAL" property="commission" />
    <result column="DISCOUNT" jdbcType="DECIMAL" property="discount" />
    <result column="SUMNETPREMIUM" jdbcType="DECIMAL" property="sumNetPremium" />
    <result column="LOADING" jdbcType="DECIMAL" property="loading" />
    <result column="JUDICALCODE" jdbcType="VARCHAR" property="judiCalCode" />
    <result column="JUDICALSCOPE" jdbcType="VARCHAR" property="judiCalScope" />
    <result column="UWYEAR" jdbcType="VARCHAR" property="uwYear" />
    <result column="GEOGRAPHICALAREA" jdbcType="VARCHAR" property="geographicalArea" />
    <result column="DECLARATIONIND" jdbcType="VARCHAR" property="declarationInd" />
    <result column="DECLARATIONINTERVAL" jdbcType="VARCHAR" property="declarationInterval" />
    <result column="LOWESTPREMIUMIND" jdbcType="VARCHAR" property="lowestPremiumInd" />
    <result column="LOWESTPREMCURRENCY" jdbcType="VARCHAR" property="lowestPremCurrency" />
    <result column="LOWESTPREMIUM" jdbcType="DECIMAL" property="lowestPremium" />
    <result column="COMMISSIONRATEIND" jdbcType="VARCHAR" property="commissionRateInd" />
    <result column="OUTERREMARK" jdbcType="VARCHAR" property="outerRemark" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="VALIDIND" jdbcType="VARCHAR" property="validInd" />
    <result column="FLAG" jdbcType="VARCHAR" property="flag" />
    <result column="ADJUSTMENTIND" jdbcType="VARCHAR" property="adjustmentInd" />
    <result column="SUMUWPREMIUM" jdbcType="DECIMAL" property="sumUwPremium" />
    <result column="GEOGRAPHICALAREADESC" jdbcType="VARCHAR" property="geographicalAreaDesc" />
    <result column="DISCOVERSTARTDATE" jdbcType="TIMESTAMP" property="discoverStartDate" />
    <result column="DISCOVERENDDATE" jdbcType="TIMESTAMP" property="discoverEndDate" />
    <result column="COMPENSATIONTYPE" jdbcType="VARCHAR" property="compensationType" />
    <result column="SUBPOLICYNO" jdbcType="VARCHAR" property="subPolicyNo" />
    <result column="POLICYVISATYPE" jdbcType="VARCHAR" property="policyVisaType" />
    <result column="POLICYVISASERIALNO" jdbcType="VARCHAR" property="policyVisaSerialNo" />
    <result column="ENDORVISATYPE" jdbcType="VARCHAR" property="endorVisaType" />
    <result column="ENDORVISASERIALNO" jdbcType="VARCHAR" property="endorVisaSerialNo" />
    <result column="UWYEARDAYS" jdbcType="VARCHAR" property="uwYearDays" />
    <result column="COMBINEIND" jdbcType="VARCHAR" property="combineInd" />
    <result column="BACKDAYS" jdbcType="DECIMAL" property="backDays" />
    <result column="DELAYFINALENDDATE" jdbcType="TIMESTAMP" property="delayFinalEndDate" />
    <result column="DELAYENDDATE" jdbcType="TIMESTAMP" property="delayEndDate" />
    <result column="BONUSRATE" jdbcType="DECIMAL" property="bonusRate" />
    <result column="REFERBONUSRATE" jdbcType="DECIMAL" property="referBonusRate" />
    <result column="GEOGRAPHICALAREADETAIL" jdbcType="VARCHAR" property="geographicalAreaDetail" />
    <result column="DELAYSTARTDATE" jdbcType="TIMESTAMP" property="delayStartDate" />
    <result column="DELAYTIME" jdbcType="DECIMAL" property="delayTime" />
    <result column="BUSINESSCLASS" jdbcType="VARCHAR" property="businessClass" />
    <result column="COINSIND" jdbcType="VARCHAR" property="coinsInd" />
    <result column="SPECIALREINSIND" jdbcType="VARCHAR" property="specialReinsInd" />
    <result column="UPDATECOMMISSIONIND" jdbcType="VARCHAR" property="updateCommissionInd" />
    <result column="SURRENDERIND" jdbcType="VARCHAR" property="surrenderInd" />
    <result column="DECLARATIONEXPLAIN" jdbcType="VARCHAR" property="declarationExplain" />
    <result column="RISKAPPLYTYPE" jdbcType="VARCHAR" property="riskApplyType" />
    <result column="PRODUCTEDITION" jdbcType="VARCHAR" property="productEdition" />
    <result column="ENDORCALCULATEMODE" jdbcType="VARCHAR" property="endorCalculateMode" />
    <result column="EFFECTFLAG" jdbcType="VARCHAR" property="effectFlag" />
    <result column="COINSRATE" jdbcType="DECIMAL" property="coinsRate" />
    <result column="RENEWALNO" jdbcType="VARCHAR" property="renewAlNo" />
    <result column="RENEWIND" jdbcType="VARCHAR" property="reewInd" />
    <result column="RENEWEDIND" jdbcType="VARCHAR" property="reewEdInd" />
    <result column="AUTORENEWIND" jdbcType="VARCHAR" property="autoRenewInd" />
    <result column="REPLACEDPOLICYNO" jdbcType="VARCHAR" property="replacedPolicyNo" />
    <result column="REINSFACIND" jdbcType="VARCHAR" property="reinsfacInd" />
    <result column="RISKLEVEL" jdbcType="VARCHAR" property="riskLevel" />
    <result column="KEEPAMOUNT" jdbcType="DECIMAL" property="keepAmount" />
    <result column="PRINTTIMES" jdbcType="DECIMAL" property="printTimes" />
    <result column="PRINTDATE" jdbcType="TIMESTAMP" property="printDate" />
    <result column="MOTORVEHICLESTARTDATE" jdbcType="TIMESTAMP" property="motorVehicleStartDate" />
    <result column="MOTORVEHICLEENDDATE" jdbcType="TIMESTAMP" property="motorVehicleEndDate" />
    <result column="MOTORVEHICLEPOLICYNO" jdbcType="VARCHAR" property="motorVehiclePolicyNo" />
    <result column="MOTORVEHICLECOMPANYNAME" jdbcType="VARCHAR" property="motorVehicleCompanyName" />
  </resultMap>
  <sql id="Base_Column_List">
    POLICYNO, PLANCODE, RISKCODE, STARTDATE, ENDDATE, STARTTIMEZONE, ENDTIMEZONE, COMMENCEDATE, 
    RETROACTIVESTARTDATE, RETROACTIVEENDDATE, CURRENCY, SUMVALUE, SUMINSURED, SUMGROSSPREMIUM, 
    COMMISSION, DISCOUNT, SUMNETPREMIUM, LOADING, JUDICALCODE, JUDICALSCOPE, UWYEAR, 
    GEOGRAPHICALAREA, DECLARATIONIND, DECLARATIONINTERVAL, LOWESTPREMIUMIND, LOWESTPREMCURRENCY, 
    LOWESTPREMIUM, COMMISSIONRATEIND, OUTERREMARK, REMARK, VALIDIND, FLAG, ADJUSTMENTIND, 
    SUMUWPREMIUM, GEOGRAPHICALAREADESC, DISCOVERSTARTDATE, DISCOVERENDDATE, COMPENSATIONTYPE, 
    SUBPOLICYNO, POLICYVISATYPE, POLICYVISASERIALNO, ENDORVISATYPE, ENDORVISASERIALNO, 
    UWYEARDAYS, COMBINEIND, BACKDAYS, DELAYFINALENDDATE, DELAYENDDATE, BONUSRATE, REFERBONUSRATE, 
    GEOGRAPHICALAREADETAIL, DELAYSTARTDATE, DELAYTIME, BUSINESSCLASS, COINSIND, SPECIALREINSIND, 
    UPDATECOMMISSIONIND, SURRENDERIND, DECLARATIONEXPLAIN, RISKAPPLYTYPE, PRODUCTEDITION, 
    ENDORCALCULATEMODE, EFFECTFLAG, COINSRATE, RENEWALNO, RENEWIND, RENEWEDIND, AUTORENEWIND, 
    REPLACEDPOLICYNO, REINSFACIND, RISKLEVEL, KEEPAMOUNT, PRINTTIMES, PRINTDATE, MOTORVEHICLESTARTDATE, 
    MOTORVEHICLEENDDATE, MOTORVEHICLEPOLICYNO, MOTORVEHICLECOMPANYNAME
  </sql>
  <select id="selectByPrimaryKey" parameterType="com.chinacoal.ins.proposal.car.pojo.GuPolicyRiskKey" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from GUPOLICYRISK
    where POLICYNO = #{policyno,jdbcType=VARCHAR}
      and PLANCODE = #{plancode,jdbcType=VARCHAR}
      and RISKCODE = #{riskcode,jdbcType=VARCHAR}
  </select>
 <!-- 根据分单号查询-->
  <select id="findPolicyNoBySubPolicyNo" parameterType="java.lang.String" resultType="java.lang.String">
    select a.POLICYNO as policyNo
    from GUPOLICYRISK a
    <where>
      <if test="_parameter != null">
        a.SUBPOLICYNO = #{subPolicyNo,jdbcType=VARCHAR}
      </if>
    </where>
  </select>
  <select id="findByPolicyNo" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    CASE WHEN a.surrenderInd = '1'
    THEN '1'
    WHEN (a.surrenderInd = '0' and a.endDate &lt; sysdate)
    THEN '2'
    else '0'
    end as surrenderInd,
    a.*
    from GUPOLICYRISK a
    <where>
      <if test="_parameter != null">
        a.POLICYNO = #{policyNo,jdbcType=VARCHAR}
      </if>
    </where>
  </select>
  <select id="findAddFiledByProposalNo" parameterType="java.lang.String" resultType="com.chinacoal.ins.proposal.car.vo.ProposalAddFieldVo">
    select
      max(b.payway) as payWay, max(b.paydate) as payDate
    from gppayfeeinfo a, gptradeinfo b
    where a.tradeno = b.tradeno
    <if test="_parameter!=null">
      and a.businessno = #{proposalNo,jdbcType=VARCHAR}
    </if>
  </select>
</mapper>